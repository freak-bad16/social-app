<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile | MiniSocial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
    </style>
</head>

<body class="bg-zinc-600 min-h-screen text-white">

    <!-- Top Navbar -->
    <nav class="bg-zinc-800 px-6 py-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-0 shadow-md">
        <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6">
            <a href="/main" class="text-2xl font-bold hover:text-indigo-400 transition duration-200">MiniSocial</a>

            <a href="/profile" class="text-white hover:text-indigo-400 text-lg font-medium">
                üòä <%= user.userName %>
            </a>
        </div>
        <a href="/logout"
            class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium transition w-full sm:w-auto text-center">
            Logout
        </a>
    </nav>

    <!-- Main Content -->
    <div class="mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-6">

        <!-- Left Sidebar (40% on large screens) -->
        <div class="lg:col-span-4 bg-slate-200 text-gray-800 rounded-xl p-6 shadow-md flex flex-col justify-between h-auto md:h-[82vh]">

            <!-- Profile Section -->
            <div class="p-6 bg-white rounded-xl shadow-md w-full mx-auto">
                <div class="flex items-center gap-6 mb-6">
                  <!-- Profile Picture -->
                  <div class="w-20 h-20 rounded-full overflow-hidden border-2 border-gray-300">
                    <img src="/images/uplodes/<%= user.profilePic %>" alt="Profile Picture" class="object-cover w-full h-full">
                  </div>
              
                  <!-- Welcome Text -->
                  <div>
                    <h2 class="text-2xl font-bold text-gray-800">
                      Welcome, <%= user.userName %>
                    </h2>
                    <h4 class="text-gray-500 text-sm">
                      Here is your profile
                    </h4>
                  </div>
                </div>
              
            
                <!-- User Info -->
                <div class="space-y-3 text-sm text-gray-700">
                  <p><strong>Name:</strong> <%= user.name %></p>
                  <p><strong>Age:</strong> <%= user.age %></p>
                  <p><strong>Email:</strong> <%= user.email %></p>
                </div>
              
            
                <!-- Edit Profile Link -->
                <div class="mt-4">
                  <a href="/profile-edit" class="text-blue-600 hover:underline text-sm font-medium">Edit Profile</a>
                </div>
              </div>
              
            <!-- Post Input Section -->
            <div class="p-6 bg-white rounded-xl shadow-md w-full mx-auto">
                <form action="/post" method="post" class="mt-6 md:mt-0">
                    <h2 class="text-xl font-semibold mb-3">Post something</h2>
                    <textarea placeholder="What's on your mind?" rows="3" name="content"
                        class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 resize-none"></textarea>
                    <button type="submit"
                        class="mt-3 bg-indigo-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition duration-200 w-full sm:w-auto">
                        Post
                    </button>
                </form>
            </div>
        </div>

        <!-- Right Post Feed (55% on large screens) -->
        <div class="lg:col-span-7 p-6 max-w-[100%] mx-auto">
            <% user.posts.reverse().forEach(post => { %>
                <div class="bg-zinc-700 p-5 rounded-xl shadow-md mb-6">
                    <!-- Post Header with Profile and Time -->
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-gray-300">
                            <img src="/images/uplodes/<%= user.profilePic %>" alt="Profile Picture" class="object-cover w-full h-full">
                        </div>
                        <div>
                            <p class="text-white font-bold">@<%= user.userName %></p>
                            <small class="text-gray-400"><%= post.createdAt?.toLocaleString() %></small>
                        </div>
                    </div>
            
                    <!-- Post Content -->
                    <p class="text-white mb-4"><%= post.content %></p>
            
                    <!-- Like Button -->
                    <form action="/like/<%= post._id %>" method="POST">
                        <div class="flex justify-between text-sm text-gray-300">
                            <% const isLiked = post.likes.includes(user._id.toString()); %>
            
                            <button type="submit" class="hover:text-red-400 transition">
                                <% if (isLiked) { %>
                                    ‚ù§Ô∏è <%= post.likes.length %>
                                <% } else { %>
                                    ü§ç <%= post.likes.length %>
                                <% } %>
                            </button>
            
                            <!-- Edit Button -->
                            <a href="/post-edit/<%= post._id %>" class="text-gray-300 hover:text-indigo-500">‚úèÔ∏è Edit</a>
            
                            <!-- Delete Button -->
                            <button formaction="/delete/<%= post._id %>" method="post"
                                class="hover:text-indigo-500 bg-transparent border-none cursor-pointer">
                                üóëÔ∏è Delete
                            </button>
                        </div>
                    </form>
                </div>
            <% }) %>
        </div>
    </div>

</body>

</html>
